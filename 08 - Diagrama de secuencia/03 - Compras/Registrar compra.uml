@startuml

== Registrar Compra ==

Usuario -> PantallaCompras : ingresarProveedor(nombre)
activate PantallaCompras
PantallaCompras -> ControladorCompras : buscarProveedor(nombre)
activate ControladorCompras

ControladorCompras -> Proveedores : buscarPorNombre(nombre)
activate Proveedores

alt proveedor encontrado
    Proveedores --> ControladorCompras : <<lista>>
    deactivate Proveedores
    ControladorCompras --> PantallaCompras : <<proveedoresEncontrados>>
    PantallaCompras --> Usuario : <<Lista de proveedores>>
    Usuario -> PantallaCompras : seleccionarProveedor
else no encontrado
    Proveedores --> ControladorCompras : <<sinResultados>>
    deactivate Proveedores
    ControladorCompras --> PantallaCompras : <<Proveedor no encontrado>>
    PantallaCompras --> Usuario : <<mensaje="Proveedor no registrado">>
end

Usuario -> PantallaCompras : completarDatos(marca, modelo, cantidad)
PantallaCompras -> ControladorCompras : validarDatos(marca, modelo, cantidad)

alt datos válidos
    ControladorCompras --> PantallaCompras : <<solicitarConfirmacion>>
    Usuario -> PantallaCompras : confirmar
    PantallaCompras -> ControladorCompras : registrarCompra
    ControladorCompras -> Compra : crear
    activate Compra
    Compra -> Inventario : actualizarStock
    activate Inventario
    Inventario --> Compra : <<stockActualizado>>
    deactivate Inventario
    Compra --> ControladorCompras : <<confirmada>>
    deactivate Compra
    ControladorCompras --> PantallaCompras : <<Compra registrada>>
    PantallaCompras --> Usuario : <<mensaje="Compra Registrada">>
else datos inválidos
    ControladorCompras --> PantallaCompras : <<datosInvalidos>>
    PantallaCompras --> Usuario : <<mensaje="Datos Invalidos">>
end

== Cancelación ==
Usuario -> PantallaCompras : cancelar()
PantallaCompras -> ControladorCompras : cancelarOperacion()
ControladorCompras --> PantallaCompras : <<cancelado>>
deactivate ControladorCompras
PantallaCompras --> Usuario : <<Compra cancelada>>
deactivate PantallaCompras

@enduml
