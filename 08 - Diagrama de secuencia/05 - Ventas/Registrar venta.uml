@startuml

== Registrar Venta ==

actor Usuario

Usuario -> PantallaVentas : ingresarCliente(nombre)
activate PantallaVentas
PantallaVentas -> ControladorVentas : buscarCliente(nombre)
activate ControladorVentas

ControladorVentas -> Clientes : buscarPorNombre(nombre)
activate Clientes

alt cliente encontrado
    Clientes --> ControladorVentas : <<lista>>
    deactivate Clientes
    ControladorVentas --> PantallaVentas : <<clientesEncontrados>>
    PantallaVentas --> Usuario : <<Lista de clientes>>
    Usuario -> PantallaVentas : seleccionarCliente
else no encontrado
    Clientes --> ControladorVentas : <<sinResultados>>
    deactivate Clientes
    ControladorVentas --> PantallaVentas : <<Cliente no encontrado>>
    PantallaVentas --> Usuario : <<mensaje="Cliente no registrado">>
end

Usuario -> PantallaVentas : completarDatos(marca, modelo, cantidad)
PantallaVentas -> ControladorVentas : validarDatos(marca, modelo, cantidad)

activate ControladorVentas
alt datos válidos
    ControladorVentas --> PantallaVentas : <<solicitarConfirmacion>>
    Usuario -> PantallaVentas : confirmar
    PantallaVentas -> ControladorVentas : registrarVenta

    ControladorVentas -> Venta : crear
    activate Venta

    Venta -> Inventario : descontarStock
    activate Inventario
    Inventario --> Venta : <<stockActualizado>>
    deactivate Inventario

    Venta --> ControladorVentas : <<confirmada>>
    deactivate Venta

    ControladorVentas --> PantallaVentas : <<Venta registrada>>
    PantallaVentas --> Usuario : <<mensaje="Venta Registrada">>

else datos inválidos
    ControladorVentas --> PantallaVentas : <<datosInvalidos>>
    PantallaVentas --> Usuario : <<mensaje="Datos Invalidos">>
end

== Cancelación ==
Usuario -> PantallaVentas : cancelar()
PantallaVentas -> ControladorVentas : cancelarOperacion()
ControladorVentas --> PantallaVentas : <<cancelado>>
deactivate ControladorVentas
PantallaVentas --> Usuario : <<Venta cancelada>>
deactivate PantallaVentas

@enduml
