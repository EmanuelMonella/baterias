@startuml
actor Usuario
participant PantallaGestionBaterias
participant ControladorStock
participant BaseDeDatos

== Inicio ==
Usuario -> PantallaGestionBaterias : seleccionarBateria()
activate PantallaGestionBaterias

PantallaGestionBaterias -> ControladorStock : solicitarMotivosBaja()
activate ControladorStock

ControladorStock --> PantallaGestionBaterias : <<Motivos[Defecto, Fin de vida útil, Retiro del mercado]>>
PantallaGestionBaterias --> Usuario : <<Motivos>>
Usuario -> PantallaGestionBaterias : seleccionarMotivo(motivo)
PantallaGestionBaterias -> ControladorStock : enviarMotivo(motivo)
ControladorStock --> PantallaGestionBaterias : <<>>
PantallaGestionBaterias --> Usuario : <<string: Confirme operacion>>

== Confirmación ==
alt Usuario no confirma
    Usuario -> PantallaGestionBaterias : cancelarConfirmación()
    PantallaGestionBaterias -> ControladorStock : cancelarBaja()
    ControladorStock --> PantallaGestionBaterias : <<Operacion cancelada>>
    PantallaGestionBaterias --> Usuario : <<mensaje: operacion cancelada>>
    
else Usuario confirma
    Usuario -> PantallaGestionBaterias : confirmarOperacion()
    PantallaGestionBaterias -> ControladorStock : bajaConfirmada(motivo)

    ControladorStock -> BaseDeDatos : actualizarEstado("Inactiva")
    activate BaseDeDatos
    BaseDeDatos --> ControladorStock : ok
    deactivate BaseDeDatos

    ControladorStock -> PantallaGestionBaterias : ok
    PantallaGestionBaterias --> Usuario : <<Baja exitosa>>
    deactivate ControladorStock
end

== Flujo alternativo: descartar ==
Usuario -> PantallaGestionBaterias : clickDescartar()
PantallaGestionBaterias --> Usuario : <<>>
deactivate PantallaGestionBaterias

@enduml
